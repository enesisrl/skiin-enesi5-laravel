
# -------------------------------------------------------------------------------------------------
# Proper MIME type for all files (https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess)
# -------------------------------------------------------------------------------------------------

# JavaScript
AddType	application/javascript			js jsonp
AddType	application/json			json

# Audio
AddType	audio/ogg				oga ogg
AddType	audio/mp4				m4a f4a f4b

# Video
AddType	video/ogg				ogv
AddType	video/mp4				mp4 m4v f4v f4p
AddType	video/webm				webm
AddType	video/x-flv				flv

# SVG
AddType		image/svg+xml			svg svgz
AddEncoding	gzip				svgz

# Webfonts
AddType application/vnd.ms-fontobject		eot
AddType application/x-font-ttf			ttf ttc
AddType font/opentype				otf
AddType application/x-font-woff			woff

# Assorted types
AddType	image/x-icon				ico
AddType	image/webp				webp
AddType	text/cache-manifest			appcache manifest
AddType	text/x-component			htc
AddType	application/xml				rss atom xml rdf
AddType	application/x-chrome-extension		crx
AddType	application/x-opera-extension		oex
AddType	application/x-xpinstall			xpi
AddType	application/octet-stream		safariextz
AddType	application/x-web-app-manifest+json	webapp
AddType	text/x-vcard				vcf
AddType	application/x-shockwave-flash		swf
AddType	text/vtt				vtt


# -------------------------------------------------------------------------------------------------
# Browser Caching: http://code.google.com/speed/page-speed/docs/caching.html#LeverageBrowserCaching
# -------------------------------------------------------------------------------------------------

<IfModule mod_expires.c>
	ExpiresActive On

        ExpiresDefault "access plus 30 days

	#ExpiresByType application/json			"access plus 1 year"
	ExpiresByType application/pdf			"access plus 1 year"
	ExpiresByType application/x-shockwave-flash	"access plus 1 year"
	ExpiresByType image/bmp 			"access plus 1 year"
	ExpiresByType image/gif 			"access plus 1 year"
        ExpiresByType image/jpg                         "access plus 1 year"
	ExpiresByType image/jpeg 			"access plus 1 year"
	ExpiresByType image/png 			"access plus 1 year"
	ExpiresByType image/svg+xml 			"access plus 1 year"
	ExpiresByType image/tiff 			"access plus 1 year"
	ExpiresByType image/vnd.microsoft.icon 		"access plus 1 year"
  	ExpiresByType image/x-icon			"access plus 1 year"
	ExpiresByType text/css 				"access plus 1 year"
	ExpiresByType video/x-flv 			"access plus 1 year"
	ExpiresByType application/vnd.bw-fontobject	"access plus 1 year"
	ExpiresByType application/x-font-ttf		"access plus 1 year"
	ExpiresByType application/font-woff		"access plus 1 year"
	ExpiresByType font/opentype			"access plus 1 year"
	ExpiresByType image/webp			"access plus 1 year"

	# The following MIME types are in the process of registration
	ExpiresByType application/xslt+xml		"access plus 1 year"
	ExpiresByType image/svg+xml			"access plus 1 year"

	# The following MIME types are NOT registered
	ExpiresByType application/mathml+xml		"access plus 1 year"
	ExpiresByType application/rss+xml		"access plus 1 year"

	# JavaScript has various MIME types
	ExpiresByType application/x-javascript 		"access plus 1 year"
	ExpiresByType application/javascript 		"access plus 1 year"
	ExpiresByType text/ecmascript 			"access plus 1 year"
	ExpiresByType text/javascript 			"access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
	# Try removing etag headers (if it's coming from proxy for example)
	Header unset ETag
</IfModule>


# -------------------------------------------------------------------------------------------------
# BEGIN Cache-Control Headers
# -------------------------------------------------------------------------------------------------

<ifModule mod_headers.c>
    <filesMatch "\.(ico|jpe?g|png|gif|swf|cur|woff|css)$">
        Header set Cache-Control "public"
    </filesMatch>
    <filesMatch "\.(js)$">
        Header set Cache-Control "private"
    </filesMatch>
    <filesMatch "\.(x?html?|php)$">
        Header set Cache-Control "private, must-revalidate"
    </filesMatch>
    <filesMatch "\.(json)$">
        Header set Access-Control-Allow-Origin "*"
    </filesMatch>
</ifModule>


# -------------------------------------------------------------------------------------------------
#gzip compression
# -------------------------------------------------------------------------------------------------

<IfModule mod_deflate.c>
	# html, xml, css, and js:
	AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/x-javascript text/javascript application/javascript application/json
	# webfonts and svg:
	<FilesMatch "\.(ttf|otf|eot|svg)$" >
		SetOutputFilter DEFLATE
	</FilesMatch>
</IfModule>


<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews -Indexes
    </IfModule>

    # Redirect to HTTPS
    RewriteEngine On

    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]


    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # Redirect Trailing Slashes If Not A Folder...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]

    # Redirect da index.php a /
    RewriteCond %{THE_REQUEST} ^.*/index\.php
    RewriteRule ^index.php / [R=301,L,QSD]

    # Send Requests To Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]
</IfModule>



